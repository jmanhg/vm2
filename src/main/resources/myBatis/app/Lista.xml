<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="mx.com.oposicion.persistence.ListaMapper">


	<sql id="camposLista">
                        idlista,
                        nombre,
                        fecha,
                        activo,
                        idusuario
        </sql>


    <resultMap id="listaMap" type="ListaType" >
        <result property="idlista" column="idlista"/>
        <result property="nombre" column="nombre"/>
        <result property="fecha" column="fecha"/>
        <result property="activo" column="activo"/>
        <result property="idusuario" column="idusuario"/>
    </resultMap>


    <select id="findById" resultMap="listaMap" parameterType="java.lang.Integer">
		SELECT 
			<include refid="camposLista"/>
		FROM 
			lista
		WHERE 
			idlista=#{idlista}
                        and activo=1
    </select>
    
    <select id="findByIdUsuario" resultMap="listaMap" parameterType="java.lang.Integer">
		SELECT 
			<include refid="camposLista"/>
		FROM 
			lista
		WHERE 
			idusuario=#{idusuario}
                        and activo=1
    </select>


    <select id="getAll" resultMap="listaMap">
		SELECT 
			<include refid="camposLista"/>
		FROM 
			lista 
                WHERE activo=1
    </select>


	<insert id="insert" parameterType="ListaType">
		INSERT INTO lista( <include refid="camposLista"/> )
 		VALUES(
 			null,
			#{nombre},
                        sysdate(),
                        #{activo},
                        #{idusuario}
                
		)	
		<selectKey keyProperty="idlista" resultType="int">
			SELECT last_insert_id() AS idlista
		</selectKey>
    </insert>


	<update id="update" parameterType="ListaType">
			UPDATE lista SET
				nombre=#{nombre},
                                fecha=sysdate(),
                                activo=#{activo},
                                idusuario=#{idusuario}
			WHERE
              	idlista = #{idlista}
    </update>


	<update id="delete" parameterType="ListaType">
			UPDATE lista SET
				activo = 0
			WHERE
              	idlista = #{idlista}
            
    </update>


</mapper>
