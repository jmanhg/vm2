<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd" > 

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                template="../support/templates/ComplexTemplate.xhtml">

    <ui:define name="pageName">Captura Figurativo </ui:define>
    <ui:define name="content">

        <f:view encoding="UTF-8" contentType="text/html">
            <h:head>
                <title>#{translatedMessage['title.message']}</title>
                <style>
                    .ui-autocomplete-panel {
                        max-width: 700px;
                        z-index: 2012;
                        overflow:auto;
                     }
                </style>
            </h:head>
            <h:body>
                <h:form id="forma">
                    <p:focus context="panelSearch"/> 
              <!--      
<p:ajaxStatus onstart="statusDialog.show()" onsuccess="statusDialog.hide()" />
 

<p:dialog modal="true" widgetVar="statusDialog" header="Status" draggable="false" closable="false" resizable="false">  
    <p:graphicImage value="/images/ajax-loader_2.gif" />  
</p:dialog>  -->

                    <p:panel  style="width: 100%" id="panelSearch" >  
                       
                             
                        <p:fieldset legend="Busqueda Marcas">
                                  <p:panelGrid  columns="5"  style="border-width: 0px"> 
                                            <h:outputText value="idRegistro" />
                                            <h:outputText value="Tipo" />
                                            <h:outputText value="Subtipo" />
                                            <h:outputText value="Registro" />
                                            <p:commandButton actionListener="#{oposicionCapturaMB.searchRegistro}" update="gacetaTable" value="Buscar Gaceta..."  style="margin:0"/>  
                                             
                                            <p:inputText value="#{oposicionCapturaMB.idRegistro}" />
                                            <p:inputText value="#{oposicionCapturaMB.tipo}" />
                                            <p:inputText value="#{oposicionCapturaMB.subtipo}" />
                                            <p:inputText value="#{oposicionCapturaMB.registro}" />
                                            <p:commandButton actionListener="#{oposicionCapturaMB.searchRegistroV}" update="gacetaTableV" value="Buscar Marcas..."  style="margin:0"/>  
                                           
                                            <h:outputText value="Solicitud" />
                                            <h:outputText value="Denominación" />
                                            <h:outputText value="Clase" />
                                            <h:outputText value="" />
                                            <h:outputText value="" />
                                            <p:inputText value="#{oposicionCapturaMB.solicitud}" />
                                            <p:inputText value="#{oposicionCapturaMB.denominacion}" />
                                            <p:inputText value="#{oposicionCapturaMB.clase}" />
                                            <h:outputText value="" />
                                            <h:outputText value="" />
                                            <h:outputText value="Titular" />
                                            <h:outputText value="Apoderado" />
                                            <h:outputText value="" />
                                            <h:outputText value="" />
                                            <h:outputText value="" />
                                            <p:inputText value="#{oposicionCapturaMB.titular}" />
                                            <p:inputText value="#{oposicionCapturaMB.apoderado}" />
                                            <h:outputText value="" />
                                            <h:outputText value="" />
                                            <h:outputText value="" />
                                            </p:panelGrid>
                            <table border="0" spacing="5" style="width: 100%; ">
                                <tr>
                                    <td style="width: 50%;vertical-align: top">
                                        <p:panel style="width: 100%" header="Gacetadata" >
                                              <p:dataTable id="gacetaTable" 
                                     var="gacetadataSelected" 
                                     value="#{oposicionCapturaMB.gacetadataDataModel}" 
                                     selectionMode="single"
                                     resizableColumns="true" 
                                     paginator="true" rows="5"
                                     paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                     rowsPerPageTemplate="5,10,15,25"
                                     emptyMessage="No se encontraron registros"
                                     liveResize="true"
                                     rowIndexVar="rowIndex1"
                                    >
                            
                                               <p:ajax event="rowSelect" listener="#{oposicionCapturaMB.onRowSelectGacetadataC}" update="gacetaTable :forma:gacetadataVienaTable" /> 
                           
                            <f:facet name="header">  
                                <h:outputText value="" />
                            </f:facet>
                             <p:column headerText="N°" style="width:15px">
                                #{rowIndex1+1}
                            </p:column>
                             <p:column style="width:15px" rendered="false">
                                <f:facet name="header" >idRegistro</f:facet>
                                <h:outputText value="#{gacetadataSelected.idRegistro}"  />
                            </p:column>
                            <p:column style="width:15px" >
                                <f:facet name="header" >Tipo</f:facet>
                                <h:outputText value="#{gacetadataSelected.tipo}"  />
                            </p:column>
                             <p:column style="width:15px" >
                                <f:facet name="header" >Subtipo</f:facet>
                                <h:outputText value="#{oposicionCapturaMB.tipoM(gacetadataSelected.subtipo)}"  />
                            </p:column>
                            <p:column style="width:15px" rendered="false">
                                <f:facet name="header" >Registro</f:facet>
                                <h:outputText value="#{gacetadataSelected.registro}"  />
                            </p:column>
                            <p:column style="width:15px" rendered="false">
                                <f:facet name="header" >Solicitud</f:facet>
                                <h:outputText value="#{gacetadataSelected.solicitud}"  />
                            </p:column>
                             
                            <p:column style="width:100px" >
                                <f:facet name="header">Denominación</f:facet>
                                <h:outputText value="#{gacetadataSelected.titulo}" />
                            </p:column>
                            <p:column style="width:100px"   >
                                <f:facet name="header">Clases</f:facet>
                                <h:outputText value="#{gacetadataSelected.clase}" />
                            </p:column>
                           <p:column style="width:100px" >
                                <f:facet name="header">Titular</f:facet>
                                <h:outputText value="#{gacetadataSelected.titular}" />
                            </p:column>
                            <p:column style="width:100px" >
                                <f:facet name="header">Apoderado</f:facet>
                                <h:outputText value="#{gacetadataSelected.apoderado}" />
                            </p:column>
                            <p:column style="width:200px" >
                                <f:facet name="header">Imagen</f:facet>
                                
                                <img style="height: 100px;#{gacetadataSelected.diseno=='1'?'':'visibility: hidden;'}" src="#{facesContext.externalContext.requestContextPath}/MostrarReporte?content=image/gif&amp;idRegistro=#{gacetadataSelected.idRegistro}" alt="" />
                               
                            </p:column>                
                            
                             <f:facet name="footer"  >   
                                <p:spacer height="10" width="0" />
                       <p:commandButton actionListener="#{oposicionCapturaMB.searchLimpia}" update="gacetaTable" value="Limpiar Gaceta..."  style="margin:0"/>  
                                           
                                            
                            </f:facet>
                              
                        </p:dataTable> 
                                        </p:panel> 
                                    </td>
                                    <td style=";vertical-align: top">
                                           <p:panel style="width: 100%" header="GacetadataV" >
                                              <p:dataTable id="gacetaTableV" 
                                     var="gacetadataSelectedV" 
                                     value="#{oposicionCapturaMB.gacetadataDataModelV}" 
                                     selectionMode="single"
                                     resizableColumns="true" 
                                     paginator="true" rows="5"
                                     paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                     rowsPerPageTemplate="5,10,15,25"
                                     emptyMessage="No se encontraron registros"
                                     liveResize="true"
                                     rowIndexVar="rowIndex1"
                                    >
                            
                                               <p:ajax event="rowSelect" listener="#{oposicionCapturaMB.onRowSelectGacetadataCV}" update="gacetaTableV :forma:gacetadataVienaTableV" /> 
                           
                            <f:facet name="header">  
                                <h:outputText value="" />
                            </f:facet>
                             <p:column headerText="N°" style="width:15px">
                                #{rowIndex1+1}
                            </p:column>
                             <p:column style="width:15px" rendered="false">
                                <f:facet name="header" >idRegistro</f:facet>
                                <h:outputText value="#{gacetadataSelectedV.idRegistro}"  />
                            </p:column>
                            <p:column style="width:15px" >
                                <f:facet name="header" >Tipo</f:facet>
                                <h:outputText value="#{gacetadataSelectedV.tipo}"  />
                            </p:column>
                             <p:column style="width:15px" >
                                <f:facet name="header" >Subtipo</f:facet>
                                <h:outputText value="#{oposicionCapturaMB.tipoM(gacetadataSelectedV.subtipo)}"  />
                            </p:column>
                            <p:column style="width:15px" rendered="false">
                                <f:facet name="header" >Registro</f:facet>
                                <h:outputText value="#{gacetadataSelectedV.registro}"  />
                            </p:column>
                            <p:column style="width:15px" rendered="false">
                                <f:facet name="header" >Solicitud</f:facet>
                                <h:outputText value="#{gacetadataSelectedV.solicitud}"  />
                            </p:column>
                             
                            <p:column style="width:100px" >
                                <f:facet name="header">Denominación</f:facet>
                                <h:outputText value="#{gacetadataSelectedV.titulo}" />
                            </p:column>
                            <p:column style="width:100px"   >
                                <f:facet name="header">Clases</f:facet>
                                <h:outputText value="#{gacetadataSelectedV.clase}" />
                            </p:column>
                           <p:column style="width:100px" >
                                <f:facet name="header">Titular</f:facet>
                                <h:outputText value="#{gacetadataSelectedV.titular}" />
                            </p:column>
                            <p:column style="width:100px" >
                                <f:facet name="header">Apoderado</f:facet>
                                <h:outputText value="#{gacetadataSelectedV.apoderado}" />
                            </p:column>
                            <p:column style="width:200px" >
                                <f:facet name="header">Imagen</f:facet>
                                
                                <img style="height: 100px;#{gacetadataSelectedV.diseno=='1'?'':'visibility: hidden;'}" src="#{facesContext.externalContext.requestContextPath}/MostrarReporte?content=image/gif&amp;g=v&amp;idRegistro=#{gacetadataSelectedV.idRegistro}" alt="" />
                               
                            </p:column>                
                            
                             <f:facet name="footer"  >   
                                <p:spacer height="10" width="0" />
                         <p:commandButton actionListener="#{oposicionCapturaMB.searchLimpiaV}" update="gacetaTableV" value="Limpiar Marcas..."  style="margin:0"/>  
                     
                                            
                            </f:facet>
                              
                        </p:dataTable> 
                                        </p:panel> 
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2" style=";vertical-align: top">
                                         <p:fieldset legend="Agregar código Viena">
                                  <p:panelGrid  columns="3"  style="border-width: 0px"> 
                                           
                                      <h:outputText value="Código Viena:" style="width: 100px" />
                                       <p:autoComplete   value="#{oposicionCapturaMB.selectedCatViena}" id="catVienaPojoC" completeMethod="#{oposicionCapturaMB.completeCatViena}" size="100"
                                                        var="c" itemLabel="#{c.name}" itemValue="#{c}" converter="catVienaConverter" forceSelection="true" immediate="true"
                                             dropdown="true" scrollHeight="250"
                                             >
                                        <p:ajax event="itemSelect" listener="#{oposicionCapturaMB.selectListenerCatViena}"  />
                                        <p:ajax event="itemUnselect" listener="#{oposicionCapturaMB.unSelectListenerCatViena}" />
                                    </p:autoComplete>
                                       <p:commandButton actionListener="#{oposicionCapturaMB.guardaCV}" update="gacetadataVienaTable" value="Agregar"  style="margin:0;width: 100px;text-align: left"/>  
                                            
                                  </p:panelGrid>
                            </p:fieldset>
                                    </td>
                                </tr>
                                <tr>
                                    <td style=";vertical-align: top">
                                        <p:outputPanel id="panelTabla" >         
                    <p:panel style="width: 100%" header="Código Viena" >
                       
                        
                        
                         <p:dataTable id="gacetadataVienaTable" 
                                     var="gacetadataVienaSelected" 
                                     value="#{oposicionCapturaMB.gacetadataVienaDataModel}" 
                                     selectionMode="single"
                                     resizableColumns="true" 
                                     paginator="true" rows="15"
                                     paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                     rowsPerPageTemplate="5,10,15,25"
                                     emptyMessage="No se encontraron registros"
                                     liveResize="true"
                                     rowIndexVar="rowIndex1"
                                    >
                           <p:ajax event="rowSelect" listener="#{oposicionCapturaMB.onRowSelectGacetadataViena}" update="gacetadataVienaTable " /> 

                            <f:facet name="header">  
                                RESULTADOS
                            </f:facet>
                             <p:column headerText="N°" style="width:5px">
                                #{rowIndex1+1}
                            </p:column>
                           <p:column style="width:10px" rendered="false">
                                <f:facet name="header" >key</f:facet>
                                <h:outputText value="#{gacetadataVienaSelected.idkey}"  />
                            </p:column>
                            <p:column style="width:5px" >
                                <f:facet name="header" >secuencia</f:facet>
                                <h:outputText value="#{gacetadataVienaSelected.secuencia}"  />
                            </p:column>
                             
                            <p:column style="width:50px" rendered="false">
                                <f:facet name="header">Solicitud</f:facet>
                                <h:outputText value="#{gacetadataVienaSelected.solicitud}" />
                            </p:column>
                            
                           <p:column style="width:20px" sortBy="#{gacetadataVienaSelected.categoria}.#{gacetadataVienaSelected.division}.#{gacetadataVienaSelected.seccion}">
                                <f:facet name="header">Clasificación viena</f:facet>
                                <h:outputText value="#{gacetadataVienaSelected.categoria}.#{gacetadataVienaSelected.division}.#{gacetadataVienaSelected.seccion}" />
                            </p:column>
                            
                           <p:column style="width:150px" sortBy="#{oposicionCapturaMB.descripcionV(gacetadataVienaSelected.idkey)}">
                                <f:facet name="header">Descripción</f:facet>
                                <h:outputText value="#{oposicionCapturaMB.descripcionV(gacetadataVienaSelected.idkey)}" />
                            </p:column>
                            
                            
                            <p:column style="width:10px" headerText="Borrar" exportable="false">  
                                <p:commandButton id="deleteButton" update=":forma:dlgBorrar2" oncomplete="dlgBorrar2.show()"  icon="ui-icon-closethick" title="Borrar">  
                                    <f:setPropertyActionListener value="#{gacetadataVienaSelected}" target="#{oposicionCapturaMB.gacetadataVienaSelected}"  />  
                                </p:commandButton>  
                            </p:column> 
                            
                             <f:facet name="footer"  >   
                                <p:spacer height="10" width="0" />
                        
                            </f:facet>
                              
                        </p:dataTable> 
                       

                       
                        </p:panel>

                            </p:outputPanel>
                                    </td>
                                    <td style=";vertical-align: top">
                                                <p:outputPanel id="panelTablaV" >         
                    <p:panel style="width: 100%" header="Código Viena V" >
                       
                        
                        
                         <p:dataTable id="gacetadataVienaTableV" 
                                     var="gacetadataVienaSelectedV" 
                                     value="#{oposicionCapturaMB.gacetadataVienaDataModelV}" 
                                     selectionMode="single"
                                     resizableColumns="true" 
                                     paginator="true" rows="15"
                                     paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                     rowsPerPageTemplate="5,10,15,25"
                                     emptyMessage="No se encontraron registros"
                                     liveResize="true"
                                     rowIndexVar="rowIndex1"
                                    >
                           <p:ajax event="rowSelect" listener="#{oposicionCapturaMB.onRowSelectGacetadataVienaV}" update="gacetadataVienaTableV " /> 

                            <f:facet name="header">  
                                RESULTADOS
                            </f:facet>
                             <p:column headerText="N°" style="width:5px">
                                #{rowIndex1+1}
                            </p:column>
                           <p:column style="width:10px" rendered="false">
                                <f:facet name="header" >key</f:facet>
                                <h:outputText value="#{gacetadataVienaSelectedV.idkey}"  />
                            </p:column>
                            <p:column style="width:5px" >
                                <f:facet name="header" >secuencia</f:facet>
                                <h:outputText value="#{gacetadataVienaSelectedV.secuencia}"  />
                            </p:column>
                             
                            <p:column style="width:50px" rendered="false">
                                <f:facet name="header">Solicitud</f:facet>
                                <h:outputText value="#{gacetadataVienaSelectedV.solicitud}" />
                            </p:column>
                            
                           <p:column style="width:20px" sortBy="#{gacetadataVienaSelectedV.categoria}.#{gacetadataVienaSelectedV.division}.#{gacetadataVienaSelectedV.seccion}">
                                <f:facet name="header">Clasificación viena</f:facet>
                                <h:outputText value="#{gacetadataVienaSelectedV.categoria}.#{gacetadataVienaSelectedV.division}.#{gacetadataVienaSelectedV.seccion}" />
                            </p:column>
                            
                           <p:column style="width:150px" sortBy="#{oposicionCapturaMB.descripcionV(gacetadataVienaSelectedV.idkey)}">
                                <f:facet name="header">Descripción</f:facet>
                                <h:outputText value="#{oposicionCapturaMB.descripcionV(gacetadataVienaSelectedV.idkey)}" />
                            </p:column>
                            
                            
                            <p:column style="width:10px" headerText="Borrar" exportable="false">  
                                <p:commandButton id="deleteButtonV" update=":forma:dlgBorrar2V" oncomplete="dlgBorrar2V.show()"  icon="ui-icon-closethick" title="Borrar">  
                                    <f:setPropertyActionListener value="#{gacetadataVienaSelectedV}" target="#{oposicionCapturaMB.gacetadataVienaSelectedV}"  />  
                                </p:commandButton>  
                            </p:column> 
                            
                             <f:facet name="footer"  >   
                                <p:spacer height="10" width="0" />
                        
                            </f:facet>
                              
                        </p:dataTable> 
                        

                        
                        </p:panel>

                            </p:outputPanel>
                                    </td>
                                </tr>
                            </table>
                           
                       </p:fieldset>
                        
                        
                        
                                       
                       
                       
                       
                    </p:panel>
<br/>

                    <br />
                    
                            
                    <p:dialog id="reporteDialog" closeOnEscape="true" width="800" height="450"  maximizable="true"
                              header="Vista Previa" widgetVar="reporteDialog" styleClass="ui-widget-overlay"
                              position="center top" rendered="true" 
                              onShow="document.getElementById('iframeFile').src='#{facesContext.getCurrentInstance().getExternalContext().getRequest().isSecure()==false?'http':'https'}://#{facesContext.externalContext.requestServerName}:#{facesContext.externalContext.requestServerPort}#{facesContext.externalContext.requestContextPath}/MostrarReporte';">
                        <p:resizable onResize="resizeIframe()" for="reporteDialog"/>
                        <h:panelGrid  style="width: 100%">
                            <script language="javascript" type="text/javascript">
                                function resizeIframe() {
                                    var dlg = document.getElementById('forma:reporteDialog');
                                    var obj = document.getElementById('iframeFile');
                                    //alert(dlg.offsetHeight);
                                    //alert(obj.style.height);
                                    obj.style.height = dlg.offsetHeight + 'px';
                                    obj.style.width = dlg.offsetWidth + 'px';

                                    //alert(obj.style.height);
                                }
                            </script>
                            <iframe id="iframeFile" src="" width="750px" height="425px" onload='javascript:resizeIframe(this);'/>
                        </h:panelGrid>
                        <p:commandButton value="Cancelar"  oncomplete="reporteDialog.hide()" />
                    </p:dialog>
                        
                        <p:dialog id="dlgBorrar2" header="Eliminar" width="500" height="100" widgetVar="dlgBorrar2"  >

                        <p:panel style="width: 90%">
                            <h:panelGrid columns="2">
                                
                                <h:outputText value="Código Viena:" />
                                <h:outputText value="#{oposicionCapturaMB.gacetadataVienaSelected.categoria}.#{oposicionCapturaMB.gacetadataVienaSelected.division}.#{oposicionCapturaMB.gacetadataVienaSelected.seccion}"/>
                                 </h:panelGrid>                    
                        </p:panel>
                        <p:commandButton value="Borrar" actionListener="#{oposicionCapturaMB.borraGacViena(oposicionCapturaMB.gacetadataVienaSelected)}" oncomplete="dlgBorrar2.hide()" update=":forma:gacetadataVienaTable" />
                        <p:commandButton value="Cancelar"  oncomplete="dlgBorrar2.hide()" />

                    </p:dialog> 
                    
                    <p:dialog id="dlgBorrar2V" header="Eliminar" width="500" height="100" widgetVar="dlgBorrar2V"  >

                        <p:panel style="width: 90%">
                            <h:panelGrid columns="2">
                                
                                <h:outputText value="Código Viena:" />
                                <h:outputText value="#{oposicionCapturaMB.gacetadataVienaSelectedV.categoria}.#{oposicionCapturaMB.gacetadataVienaSelectedV.division}.#{oposicionCapturaMB.gacetadataVienaSelectedV.seccion}"/>
                                 </h:panelGrid>                    
                        </p:panel>
                        <p:commandButton value="Borrar" actionListener="#{oposicionCapturaMB.borraGacVienaV(oposicionCapturaMB.gacetadataVienaSelectedV)}" oncomplete="dlgBorrar2V.hide()" update=":forma:gacetadataVienaTableV" />
                        <p:commandButton value="Cancelar"  oncomplete="dlgBorrar2V.hide()" />

                    </p:dialog> 
                       
                </h:form>
            </h:body>

        </f:view>
    </ui:define>
</ui:composition>